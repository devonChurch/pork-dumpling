<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pause.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pause.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const ifvisible = require('ifvisible.js');

/**
 * Pause module.
 * @module ./pause
 */

/**
 * Class that creases a synergy between the requestAnimationFrame sequence and
 * the native OS timer. When the user moves away from the executions active tab
 * the requestAnimation frame pauses the sequence. This is great for performance
 * however if the native OS timer continues to run there will be an irregularity
 * between the two once the tab becomes active again. We therefore pause the
 * “perceived” timer in sync with the requestAniamtionFrame stream.
 */
const Pause = class {

	/**
	 * Create a pause instance.
	 * @param {class} Face - The watch face base class that this timer is bound
	 * to.
	 */
	constructor(Face) {

		this.Face = Face;
		this.listeners();
		this.activated = 0;

	}

	/**
	 * Activate the invisible API to manage the timer when the execution goes
	 * into a dormant/active state.
	 */
	listeners() {

		ifvisible
			.on('blur', () => this.activate())
			.on('focus', () => this.deactivate());

	}

	/**
	 * Activate a pause by getting a final time reference.
	 */
	activate() {

		const date = new Date();
		this.activated = date.getTime();

	}

	/**
	 * Deactivate the pause state by riffing the stared final time stamp with a
	 * new current time value. We rip the elapsed time out of the Pork Dumpling
	 * timer and continue as per usual =)
	 */
	deactivate() {

		const date = new Date();
		const deactivated = date.getTime();
		const redundant = deactivated - this.activated;

		this.Face.Timer.offset += redundant;
		this.Face.Beat.nextBeat += redundant;

	}

};

module.exports = Pause;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-._background.html">./background</a></li><li><a href="module-._beat.html">./beat</a></li><li><a href="module-._face.html">./face</a></li><li><a href="module-._graph.html">./graph</a></li><li><a href="module-._heart.html">./heart</a></li><li><a href="module-._helper.html">./helper</a></li><li><a href="module-._hue.html">./hue</a></li><li><a href="module-._pause.html">./pause</a></li><li><a href="module-._rate.html">./rate</a></li><li><a href="module-._timer.html">./timer</a></li></ul><h3>Classes</h3><ul><li><a href="module-._background-Background.html">Background</a></li><li><a href="module-._beat-Beat.html">Beat</a></li><li><a href="module-._face-Face.html">Face</a></li><li><a href="module-._graph-Graph.html">Graph</a></li><li><a href="module-._heart-Heart.html">Heart</a></li><li><a href="module-._helper-Helper.html">Helper</a></li><li><a href="module-._hue-Hue.html">Hue</a></li><li><a href="module-._pause-Pause.html">Pause</a></li><li><a href="module-._rate-Rate.html">Rate</a></li><li><a href="module-._timer-Timer.html">Timer</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Sun Mar 20 2016 17:02:17 GMT+1300 (NZDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
