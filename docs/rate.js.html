<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: rate.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: rate.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Rate module.
 * @module ./rate
 */

/**
 * Class that represents the current average heart rate in a BPM format.
 */
const Rate = class {

	/**
	 * Create a beat instance.
	 * @param {class} Face - The watch face base class that this timer is bound
	 * to.
	 */
	constructor(Face) {

		this.Face = Face;
		this.i = 0;
		this.currentBpm = '000';

	}

	/**
	 * Calculate the average BPM value.
	 */
	updateBpm() {

		const equaliser = 60000 / this.Face.Timer.elapsedTime;
		const bpm = this.Face.Beat.i * equaliser;

		this.currentBpm = Math.round(bpm);

	}

	/**
	 * Inject the BPM text onto the canvas area making sure the different text
	 * elements flow next to each other like generic text in the DOM.
	 */
	injectBpm() {

		const ctx = this.Face.ctx;
		const bpm = `${this.currentBpm}`.length &lt; 3 ? `0${this.currentBpm}` : `${this.currentBpm}`;
		const units = ' bpm';
		const y = 70;
		const hsl = `hsl(${this.Face.Hue.current}, 100%, 65%)`;
		let x = 85;

		ctx.font = '300 30px Roboto';
		ctx.fillStyle = hsl;
		ctx.fillText(bpm, x, y);
		x += ctx.measureText(bpm).width;
		ctx.font = '300 12px Roboto';
		ctx.fillStyle = hsl;
		ctx.fillText(units, x, y);

	}

	/**
	 * We update the BPM value every 60 frames to avoid possible flickering as
	 * the BPMâ€™s average constantly changes.
	 * @return {boolean} Checks if the 60 frame duration has elapsed.
	 */
	get frequency() {

		const frequency = 60;
		const status = this.i > frequency;
		this.i = status ? 0 : this.i + 1;

		return status;

	}

	/**
	 * Updates the BPM value on each requestAnimationFrame tick.
	 */
	animate() {

		if (this.frequency) this.updateBpm();
		this.injectBpm();

	}

};

module.exports = Rate;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-._background.html">./background</a></li><li><a href="module-._beat.html">./beat</a></li><li><a href="module-._face.html">./face</a></li><li><a href="module-._graph.html">./graph</a></li><li><a href="module-._heart.html">./heart</a></li><li><a href="module-._helper.html">./helper</a></li><li><a href="module-._hue.html">./hue</a></li><li><a href="module-._pause.html">./pause</a></li><li><a href="module-._rate.html">./rate</a></li><li><a href="module-._timer.html">./timer</a></li></ul><h3>Classes</h3><ul><li><a href="module-._background-Background.html">Background</a></li><li><a href="module-._beat-Beat.html">Beat</a></li><li><a href="module-._face-Face.html">Face</a></li><li><a href="module-._graph-Graph.html">Graph</a></li><li><a href="module-._heart-Heart.html">Heart</a></li><li><a href="module-._helper-Helper.html">Helper</a></li><li><a href="module-._hue-Hue.html">Hue</a></li><li><a href="module-._pause-Pause.html">Pause</a></li><li><a href="module-._rate-Rate.html">Rate</a></li><li><a href="module-._timer-Timer.html">Timer</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Sun Mar 20 2016 17:02:17 GMT+1300 (NZDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
