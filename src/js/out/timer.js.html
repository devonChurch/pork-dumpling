<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: timer.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: timer.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Timer module.
 * @module ./timer
 */

/**
 * Class that updates the elapsed time since starting the execution and injects
 * it onto the  canvas.
 */
const Timer = class {

	/**
	 * Create a timer.
	 * @param {class} Face - The watch face base class that this timer is bound
	 * to.
	 */
	constructor(Face) {

		this.Face = Face;
		this.offset = this.calculateTime();

	}

	/**
	 * Calculate the elapsed time by diffing the starting time vs the current
	 * time.
	 * @return {number} The elapsed time.
	 */
	calculateTime() {

		const date = new Date();
		const offset = this.offset || 0;
		const time = date.getTime() - offset;

		return time;

	}

	/**
	 * Turn the raw millisecond elapsed time into a formatted rendition that can
	 * be injected onto the canvas.
	 * @param {number} time - The elapsed time in milliseconds.
	 * @return {string} The elapsed time in a 00:00 format.
	 */
	formatTime(time) {

		/** Convert time into seconds. */
		time = time / 1000;

		const minutes = Math.floor(time / 60);
		const seconds = Math.floor(time % 60);

		return `${this.queryDigits(minutes)}:${this.queryDigits(seconds)}`;

	}

	/**
	 * Makes sure the current unit i.e. seconds / minutes are always comprised
	 * of two digits.
	 * @param {number} value - The current unit i.e. seconds / minutes.
	 * @return {string} Current units in a two digit format.
	 */
	queryDigits(value) {

		return `${value}`.length &lt; 2 ? `0${value}` : `${value}`;

	}

	/**
	 * Injects the formatted elapsed time onto the canvas with a centered align
	 * appearance, custom fonts and dynamic color.
	 * @param {string} format - The elapsed time in a 00:00 format.
	 */
	injectTime(format) {

		const ctx = this.Face.ctx;
		const units = ' mins';
		const y = 95;
		/**
		 * Centre text by offsetting half of the total combined text width from
		 * the canvas centre.
		 */
		const offset = (ctx.measureText(format).width + ctx.measureText(units).width) / 2;
		let x = (this.Face.size / 2) - offset;

		ctx.font = '500 12px Roboto';
		ctx.fillStyle = 'red';
		ctx.fillText(format, x, y);

		x += ctx.measureText(format).width;

		ctx.font = '300 12px Roboto';
		ctx.fillStyle = 'blue';
		ctx.fillText(units, x, y);

	}

	/**
	 * Runs through the sequence in order to update the elapsed time.
	 */
	animate() {

		const time = this.calculateTime();
		const format = this.formatTime(time);
		this.injectTime(format);

	}

};

module.exports = Timer;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-._timer.html">./timer</a></li></ul><h3>Classes</h3><ul><li><a href="module-._timer-Timer.html">Timer</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Jan 15 2016 21:38:47 GMT+1300 (NZDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
